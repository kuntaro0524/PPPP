#!/usr/bin/env python
# -*- coding: utf-8 -*-
# generated by wxGlade 0.6.3 on Wed Feb 18 23:33:09 2015

import wx
import sys,os,math
sys.path.append("/data/03.Sacla/SSSS/BLctrl-EH4/")
from Gonio import *
from MakeScheduleRe import *
import numpy

# end wxGlade


class MyFrame2(wx.Frame):
    def __init__(self, *args, **kwds):
        # begin wxGlade: MyFrame2.__init__
        kwds["style"] = wx.DEFAULT_FRAME_STYLE
        wx.Frame.__init__(self, *args, **kwds)
        self.notebook_1 = wx.Notebook(self, -1, style=0)
        self.sizer_6_staticbox = wx.StaticBox(self, -1, "Centering")
        self.notebook_1_pane_1 = wx.Panel(self.notebook_1, -1)
        self.label_8 = wx.StaticText(self, -1, "Data Directory")
        self.datadireBox = wx.TextCtrl(self, -1, "/data3/oxi/20150218/CO/")
        self.label_11 = wx.StaticText(self, -1, "Crystal ID")
        self.prefixBox = wx.TextCtrl(self, -1, "")
        self.button_7_copy_2_copy = wx.Button(self, -1, "(0) Clear settings")
        self.setZeroDegree = wx.Button(self, -1, "(1) PUSH to set 0.0 deg.")
        self.label_2 = wx.StaticText(self, -1, "Start PHI from -60.0 deg.")
        self.text_ctrl_2 = wx.TextCtrl(self, -1, "")
        self.label_2_copy_1 = wx.StaticText(self, -1, "SHOUMEN_ANGLE[deg.]")
        self.shoumenBox = wx.TextCtrl(self, -1, "", style=wx.TE_READONLY)
        self.static_line_1 = wx.StaticLine(self, -1)
        self.label_2_copy_copy = wx.StaticText(self, -1, "Push [Check button] to update", style=wx.ALIGN_CENTRE)
        self.nFramesBox = wx.TextCtrl(self, -1, "", style=wx.TE_READONLY)
        self.label_2_copy = wx.StaticText(self, -1, "frames can be collected", style=wx.ALIGN_CENTRE)
        self.nFramesBox_copy_copy = wx.TextCtrl(self, -1, "", style=wx.TE_READONLY)
        self.label_2_copy_copy_copy = wx.StaticText(self, -1, "[degs. from this crystal]", style=wx.ALIGN_CENTRE)
        self.label_2_copy_copy_copy_1 = wx.StaticText(self, -1, "Gonio info.", style=wx.ALIGN_CENTRE)
        self.label_3 = wx.StaticText(self, -1, "X")
        self.GXbox = wx.TextCtrl(self, -1, "", style=wx.TE_READONLY)
        self.label_3_copy = wx.StaticText(self, -1, "Y")
        self.GYbox = wx.TextCtrl(self, -1, "", style=wx.TE_READONLY)
        self.label_3_copy_1 = wx.StaticText(self, -1, "Z", style=wx.ALIGN_CENTRE)
        self.GZbox = wx.TextCtrl(self, -1, "", style=wx.TE_READONLY)
        self.label_3_copy_1_copy = wx.StaticText(self, -1, "PHI", style=wx.ALIGN_CENTRE)
        self.GPHIbox = wx.TextCtrl(self, -1, "", style=wx.TE_READONLY)
        self.button_1 = wx.Button(self, -1, "Gonio Info")
        self.label_1 = wx.StaticText(self.notebook_1_pane_1, -1, "Vector A", style=wx.ALIGN_CENTRE)
        self.vecAXbox = wx.TextCtrl(self.notebook_1_pane_1, -1, "", style=wx.TE_READONLY)
        self.vecAYbox = wx.TextCtrl(self.notebook_1_pane_1, -1, "", style=wx.TE_READONLY)
        self.vecAZbox = wx.TextCtrl(self.notebook_1_pane_1, -1, "", style=wx.TE_READONLY)
        self.button_7 = wx.Button(self.notebook_1_pane_1, -1, "Set A")
        self.label_1_copy_1 = wx.StaticText(self.notebook_1_pane_1, -1, "Vector B", style=wx.ALIGN_CENTRE)
        self.vecBXbox = wx.TextCtrl(self.notebook_1_pane_1, -1, "", style=wx.TE_READONLY)
        self.vecBYbox = wx.TextCtrl(self.notebook_1_pane_1, -1, "", style=wx.TE_READONLY)
        self.vecBZbox = wx.TextCtrl(self.notebook_1_pane_1, -1, "", style=wx.TE_READONLY)
        self.button_7_copy = wx.Button(self.notebook_1_pane_1, -1, "Set B")
        self.label_1_copy_2 = wx.StaticText(self.notebook_1_pane_1, -1, "Vector C", style=wx.ALIGN_CENTRE)
        self.vecCXbox = wx.TextCtrl(self.notebook_1_pane_1, -1, "", style=wx.TE_READONLY)
        self.vecCYbox = wx.TextCtrl(self.notebook_1_pane_1, -1, "", style=wx.TE_READONLY)
        self.vecCZbox = wx.TextCtrl(self.notebook_1_pane_1, -1, "", style=wx.TE_READONLY)
        self.button_7_copy_1 = wx.Button(self.notebook_1_pane_1, -1, "Set C")
        self.label_1_copy_2_copy = wx.StaticText(self.notebook_1_pane_1, -1, "Vector D", style=wx.ALIGN_CENTRE)
        self.vecDXbox = wx.TextCtrl(self.notebook_1_pane_1, -1, "", style=wx.TE_READONLY)
        self.vecDYbox = wx.TextCtrl(self.notebook_1_pane_1, -1, "", style=wx.TE_READONLY)
        self.vecDZbox = wx.TextCtrl(self.notebook_1_pane_1, -1, "", style=wx.TE_READONLY)
        self.button_7_copy_2 = wx.Button(self.notebook_1_pane_1, -1, "Set D")
        self.QuitButton = wx.Button(self.notebook_1_pane_1, -1, "Quit Program")
        self.button_7_copy_2_copy_copy = wx.Button(self.notebook_1_pane_1, -1, "Check")
        self.button_7_copy_3 = wx.Button(self.notebook_1_pane_1, -1, "Gen Schedules")
        self.button_7_copy_4 = wx.Button(self.notebook_1_pane_1, -1, "To A")
        self.button_7_copy_copy = wx.Button(self.notebook_1_pane_1, -1, "To B")
        self.button_7_copy_1_copy = wx.Button(self.notebook_1_pane_1, -1, "To C")
        self.button_7_copy_1_copy_copy = wx.Button(self.notebook_1_pane_1, -1, "To D")

        self.__set_properties()
        self.__do_layout()

        self.Bind(wx.EVT_BUTTON, self.clearAll, self.button_7_copy_2_copy)
        self.Bind(wx.EVT_BUTTON, self.push0deg, self.setZeroDegree)
        self.Bind(wx.EVT_BUTTON, self.pushGonioInfo, self.button_1)
        self.Bind(wx.EVT_BUTTON, self.setVecA, self.button_7)
        self.Bind(wx.EVT_BUTTON, self.setVecB, self.button_7_copy)
        self.Bind(wx.EVT_BUTTON, self.setVecC, self.button_7_copy_1)
        self.Bind(wx.EVT_BUTTON, self.setVecD, self.button_7_copy_2)
        self.Bind(wx.EVT_BUTTON, self.pushQuit, self.QuitButton)
        self.Bind(wx.EVT_BUTTON, self.pushCheck, self.button_7_copy_2_copy_copy)
        self.Bind(wx.EVT_BUTTON, self.pushGenerate, self.button_7_copy_3)
        self.Bind(wx.EVT_BUTTON, self.pushToA, self.button_7_copy_4)
        self.Bind(wx.EVT_BUTTON, self.pushToB, self.button_7_copy_copy)
        self.Bind(wx.EVT_BUTTON, self.pushToC, self.button_7_copy_1_copy)
        self.Bind(wx.EVT_BUTTON, self.pushToD, self.button_7_copy_1_copy_copy)
        # end wxGlade

	# KUNTARO Settings 150218
        host = '172.30.102.141'
        port = 10101
        self.s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
        self.s.connect((host,port))
        self.s.settimeout(10.0)

        self.gonio=Gonio(self.s)

	# Schedule setting

    def __set_properties(self):
        # begin wxGlade: MyFrame2.__set_properties
        self.SetTitle("KUMA system")
        self.datadireBox.SetMinSize((600, 31))
        self.prefixBox.SetMinSize((150, 31))
        self.button_7_copy_2_copy.SetMinSize((220, 33))
        self.button_7_copy_2_copy.SetFont(wx.Font(11, wx.DEFAULT, wx.NORMAL, wx.BOLD, 0, ""))
        self.setZeroDegree.SetMinSize((220, 33))
        self.setZeroDegree.SetForegroundColour(wx.Colour(66, 111, 66))
        self.setZeroDegree.SetFont(wx.Font(11, wx.DEFAULT, wx.NORMAL, wx.BOLD, 0, ""))
        self.label_2.SetFont(wx.Font(11, wx.DEFAULT, wx.NORMAL, wx.BOLD, 0, ""))
        self.label_2_copy_1.SetMinSize((250, 18))
        self.label_2_copy_1.SetFont(wx.Font(11, wx.DEFAULT, wx.NORMAL, wx.BOLD, 0, ""))
        self.shoumenBox.SetBackgroundColour(wx.Colour(192, 192, 192))
        self.shoumenBox.SetForegroundColour(wx.Colour(142, 35, 35))
        self.label_2_copy_copy.SetMinSize((300, 18))
        self.label_2_copy_copy.SetFont(wx.Font(11, wx.DEFAULT, wx.NORMAL, wx.BOLD, 0, ""))
        self.nFramesBox.SetBackgroundColour(wx.Colour(192, 192, 192))
        self.nFramesBox.SetForegroundColour(wx.Colour(142, 35, 35))
        self.label_2_copy.SetMinSize((250, 18))
        self.label_2_copy.SetFont(wx.Font(11, wx.DEFAULT, wx.NORMAL, wx.BOLD, 0, ""))
        self.nFramesBox_copy_copy.SetBackgroundColour(wx.Colour(192, 192, 192))
        self.nFramesBox_copy_copy.SetForegroundColour(wx.Colour(142, 35, 35))
        self.label_2_copy_copy_copy.SetMinSize((300, 18))
        self.label_2_copy_copy_copy.SetFont(wx.Font(11, wx.DEFAULT, wx.NORMAL, wx.BOLD, 0, ""))
        self.label_2_copy_copy_copy_1.SetMinSize((250, 18))
        self.label_2_copy_copy_copy_1.SetFont(wx.Font(11, wx.DEFAULT, wx.NORMAL, wx.BOLD, 0, ""))
        self.label_3.SetMinSize((50, 21))
        self.GXbox.SetBackgroundColour(wx.Colour(192, 192, 192))
        self.GXbox.SetForegroundColour(wx.Colour(142, 35, 35))
        self.label_3_copy.SetMinSize((50, 21))
        self.GYbox.SetBackgroundColour(wx.Colour(192, 192, 192))
        self.GYbox.SetForegroundColour(wx.Colour(142, 35, 35))
        self.label_3_copy_1.SetMinSize((50, 21))
        self.GZbox.SetBackgroundColour(wx.Colour(192, 192, 192))
        self.GZbox.SetForegroundColour(wx.Colour(142, 35, 35))
        self.label_3_copy_1_copy.SetMinSize((50, 21))
        self.GPHIbox.SetBackgroundColour(wx.Colour(192, 192, 192))
        self.GPHIbox.SetForegroundColour(wx.Colour(142, 35, 35))
        self.button_1.SetFont(wx.Font(11, wx.DEFAULT, wx.NORMAL, wx.BOLD, 0, ""))
        self.label_1.SetMinSize((59, 21))
        self.vecAXbox.SetMinSize((100, 25))
        self.vecAYbox.SetMinSize((100, 25))
        self.vecAZbox.SetMinSize((100, 25))
        self.button_7.SetMinSize((85, 25))
        self.vecBXbox.SetMinSize((100, 25))
        self.vecBYbox.SetMinSize((100, 25))
        self.vecBZbox.SetMinSize((100, 25))
        self.button_7_copy.SetMinSize((85, 25))
        self.vecCXbox.SetMinSize((100, 30))
        self.vecCYbox.SetMinSize((100, 30))
        self.vecCZbox.SetMinSize((100, 30))
        self.button_7_copy_1.SetMinSize((85, 25))
        self.vecDXbox.SetMinSize((100, 30))
        self.vecDYbox.SetMinSize((100, 30))
        self.vecDZbox.SetMinSize((100, 30))
        self.button_7_copy_2.SetMinSize((85, 25))
        self.QuitButton.SetMinSize((111, 33))
        self.QuitButton.SetBackgroundColour(wx.Colour(255, 65, 5))
        self.QuitButton.SetForegroundColour(wx.Colour(255, 0, 0))
        self.button_7_copy_2_copy_copy.SetMinSize((120, 50))
        self.button_7_copy_3.SetMinSize((200, 80))
        self.button_7_copy_3.SetBackgroundColour(wx.Colour(0, 127, 255))
        self.button_7_copy_3.SetForegroundColour(wx.Colour(0, 0, 0))
        self.button_7_copy_3.SetFont(wx.Font(11, wx.ROMAN, wx.NORMAL, wx.BOLD, 0, ""))
        self.button_7_copy_4.SetMinSize((50, 30))
        self.button_7_copy_4.SetForegroundColour(wx.Colour(128, 128, 128))
        self.button_7_copy_copy.SetMinSize((50, 30))
        self.button_7_copy_copy.SetForegroundColour(wx.Colour(128, 128, 128))
        self.button_7_copy_1_copy.SetMinSize((50, 30))
        self.button_7_copy_1_copy.SetForegroundColour(wx.Colour(128, 128, 128))
        self.button_7_copy_1_copy_copy.SetMinSize((50, 30))
        self.button_7_copy_1_copy_copy.SetForegroundColour(wx.Colour(128, 128, 128))
        # end wxGlade

    def __do_layout(self):
        # begin wxGlade: MyFrame2.__do_layout
        sizer_5 = wx.BoxSizer(wx.VERTICAL)
        sizer_6 = wx.StaticBoxSizer(self.sizer_6_staticbox, wx.HORIZONTAL)
        sizer_1 = wx.BoxSizer(wx.HORIZONTAL)
        sizer_2 = wx.BoxSizer(wx.VERTICAL)
        grid_sizer_2 = wx.GridSizer(6, 5, 0, 0)
        sizer_17 = wx.BoxSizer(wx.VERTICAL)
        sizer_19_copy_copy = wx.BoxSizer(wx.HORIZONTAL)
        sizer_19_copy = wx.BoxSizer(wx.HORIZONTAL)
        sizer_19_copy_1 = wx.BoxSizer(wx.HORIZONTAL)
        sizer_19 = wx.BoxSizer(wx.HORIZONTAL)
        sizer_18 = wx.BoxSizer(wx.HORIZONTAL)
        sizer_18.Add((20, 20), 0, wx.ADJUST_MINSIZE, 0)
        sizer_18.Add(self.label_8, 0, wx.ALIGN_CENTER_HORIZONTAL|wx.ALIGN_CENTER_VERTICAL|wx.ADJUST_MINSIZE, 0)
        sizer_18.Add(self.datadireBox, 0, wx.ALIGN_CENTER_HORIZONTAL|wx.ALIGN_CENTER_VERTICAL|wx.ADJUST_MINSIZE, 0)
        sizer_18.Add((20, 20), 0, wx.ADJUST_MINSIZE, 0)
        sizer_18.Add(self.label_11, 0, wx.ALIGN_CENTER_HORIZONTAL|wx.ALIGN_CENTER_VERTICAL|wx.ADJUST_MINSIZE, 0)
        sizer_18.Add(self.prefixBox, 0, wx.ALIGN_CENTER_HORIZONTAL|wx.ALIGN_CENTER_VERTICAL|wx.ADJUST_MINSIZE, 0)
        sizer_17.Add(sizer_18, 1, wx.EXPAND, 0)
        sizer_19.Add((150, 20), 0, wx.ADJUST_MINSIZE, 0)
        sizer_19.Add(self.button_7_copy_2_copy, 0, wx.ALIGN_CENTER_HORIZONTAL|wx.ALIGN_CENTER_VERTICAL, 0)
        sizer_19.Add((150, 20), 0, wx.ADJUST_MINSIZE, 0)
        sizer_19.Add(self.setZeroDegree, 0, wx.ADJUST_MINSIZE, 0)
        sizer_19.Add((50, 20), 0, wx.ADJUST_MINSIZE, 0)
        sizer_19.Add(self.label_2, 0, wx.ALIGN_CENTER_HORIZONTAL|wx.ALIGN_CENTER_VERTICAL|wx.ADJUST_MINSIZE, 0)
        sizer_19.Add(self.text_ctrl_2, 0, wx.ADJUST_MINSIZE, 0)
        sizer_19.Add((150, 20), 0, wx.ADJUST_MINSIZE, 0)
        sizer_19.Add((20, 20), 0, wx.ADJUST_MINSIZE, 0)
        sizer_17.Add(sizer_19, 1, wx.EXPAND, 0)
        sizer_19_copy_1.Add((150, 20), 0, wx.ADJUST_MINSIZE, 0)
        sizer_19_copy_1.Add(self.label_2_copy_1, 0, wx.ALIGN_CENTER_HORIZONTAL|wx.ALIGN_CENTER_VERTICAL|wx.ADJUST_MINSIZE, 0)
        sizer_19_copy_1.Add(self.shoumenBox, 0, wx.ADJUST_MINSIZE, 0)
        sizer_19_copy_1.Add((20, 20), 0, wx.ADJUST_MINSIZE, 0)
        sizer_17.Add(sizer_19_copy_1, 1, wx.EXPAND, 0)
        sizer_17.Add(self.static_line_1, 0, wx.EXPAND, 0)
        sizer_19_copy.Add((150, 20), 0, wx.ADJUST_MINSIZE, 0)
        sizer_19_copy.Add(self.label_2_copy_copy, 0, wx.ALIGN_RIGHT, 0)
        sizer_19_copy.Add(self.nFramesBox, 0, wx.ADJUST_MINSIZE, 0)
        sizer_19_copy.Add(self.label_2_copy, 0, wx.ALIGN_CENTER_HORIZONTAL|wx.ALIGN_CENTER_VERTICAL|wx.ADJUST_MINSIZE, 0)
        sizer_19_copy.Add(self.nFramesBox_copy_copy, 0, wx.ADJUST_MINSIZE, 0)
        sizer_19_copy.Add(self.label_2_copy_copy_copy, 0, wx.ALIGN_CENTER_HORIZONTAL|wx.ALIGN_CENTER_VERTICAL, 0)
        sizer_17.Add(sizer_19_copy, 1, wx.EXPAND, 0)
        sizer_19_copy_copy.Add((150, 20), 0, wx.ADJUST_MINSIZE, 0)
        sizer_19_copy_copy.Add(self.label_2_copy_copy_copy_1, 0, wx.ALIGN_RIGHT, 0)
        sizer_19_copy_copy.Add(self.label_3, 0, wx.ALIGN_CENTER_HORIZONTAL|wx.ALIGN_CENTER_VERTICAL, 0)
        sizer_19_copy_copy.Add(self.GXbox, 0, wx.ADJUST_MINSIZE, 0)
        sizer_19_copy_copy.Add((50, 20), 0, wx.ADJUST_MINSIZE, 0)
        sizer_19_copy_copy.Add(self.label_3_copy, 0, wx.ALIGN_CENTER_HORIZONTAL|wx.ALIGN_CENTER_VERTICAL, 0)
        sizer_19_copy_copy.Add(self.GYbox, 0, wx.ADJUST_MINSIZE, 0)
        sizer_19_copy_copy.Add((50, 20), 0, wx.ADJUST_MINSIZE, 0)
        sizer_19_copy_copy.Add(self.label_3_copy_1, 0, wx.ALIGN_CENTER_HORIZONTAL|wx.ALIGN_CENTER_VERTICAL, 0)
        sizer_19_copy_copy.Add(self.GZbox, 0, wx.ADJUST_MINSIZE, 0)
        sizer_19_copy_copy.Add((50, 20), 0, wx.ADJUST_MINSIZE, 0)
        sizer_19_copy_copy.Add(self.label_3_copy_1_copy, 0, wx.ALIGN_CENTER_HORIZONTAL|wx.ALIGN_CENTER_VERTICAL, 0)
        sizer_19_copy_copy.Add(self.GPHIbox, 0, wx.ADJUST_MINSIZE, 0)
        sizer_19_copy_copy.Add((50, 20), 0, wx.ADJUST_MINSIZE, 0)
        sizer_19_copy_copy.Add(self.button_1, 0, wx.ALIGN_CENTER_HORIZONTAL|wx.ALIGN_CENTER_VERTICAL|wx.ADJUST_MINSIZE, 0)
        sizer_17.Add(sizer_19_copy_copy, 1, wx.EXPAND, 0)
        sizer_5.Add(sizer_17, 0, wx.EXPAND, 0)
        grid_sizer_2.Add(self.label_1, 0, wx.ALIGN_CENTER_HORIZONTAL|wx.ALIGN_CENTER_VERTICAL, 0)
        grid_sizer_2.Add(self.vecAXbox, 0, wx.ALIGN_CENTER_HORIZONTAL|wx.ALIGN_CENTER_VERTICAL, 0)
        grid_sizer_2.Add(self.vecAYbox, 0, wx.ALIGN_CENTER_HORIZONTAL|wx.ALIGN_CENTER_VERTICAL, 0)
        grid_sizer_2.Add(self.vecAZbox, 0, wx.ALIGN_CENTER_HORIZONTAL|wx.ALIGN_CENTER_VERTICAL, 0)
        grid_sizer_2.Add(self.button_7, 0, wx.ALIGN_CENTER_HORIZONTAL|wx.ALIGN_CENTER_VERTICAL, 0)
        grid_sizer_2.Add(self.label_1_copy_1, 0, wx.ALIGN_CENTER_HORIZONTAL|wx.ALIGN_CENTER_VERTICAL, 0)
        grid_sizer_2.Add(self.vecBXbox, 0, wx.ALIGN_CENTER_HORIZONTAL|wx.ALIGN_CENTER_VERTICAL, 0)
        grid_sizer_2.Add(self.vecBYbox, 0, wx.ALIGN_CENTER_HORIZONTAL|wx.ALIGN_CENTER_VERTICAL, 0)
        grid_sizer_2.Add(self.vecBZbox, 0, wx.ALIGN_CENTER_HORIZONTAL|wx.ALIGN_CENTER_VERTICAL, 0)
        grid_sizer_2.Add(self.button_7_copy, 0, wx.ALIGN_CENTER_HORIZONTAL|wx.ALIGN_CENTER_VERTICAL, 0)
        grid_sizer_2.Add(self.label_1_copy_2, 0, wx.ALIGN_CENTER_HORIZONTAL|wx.ALIGN_CENTER_VERTICAL, 0)
        grid_sizer_2.Add(self.vecCXbox, 0, wx.ALIGN_CENTER_HORIZONTAL|wx.ALIGN_CENTER_VERTICAL, 0)
        grid_sizer_2.Add(self.vecCYbox, 0, wx.ALIGN_CENTER_HORIZONTAL|wx.ALIGN_CENTER_VERTICAL, 0)
        grid_sizer_2.Add(self.vecCZbox, 0, wx.ALIGN_CENTER_HORIZONTAL|wx.ALIGN_CENTER_VERTICAL, 0)
        grid_sizer_2.Add(self.button_7_copy_1, 0, wx.ALIGN_CENTER_HORIZONTAL|wx.ALIGN_CENTER_VERTICAL, 0)
        grid_sizer_2.Add(self.label_1_copy_2_copy, 0, wx.ALIGN_CENTER_HORIZONTAL|wx.ALIGN_CENTER_VERTICAL, 0)
        grid_sizer_2.Add(self.vecDXbox, 0, wx.ALIGN_CENTER_HORIZONTAL|wx.ALIGN_CENTER_VERTICAL, 0)
        grid_sizer_2.Add(self.vecDYbox, 0, wx.ALIGN_CENTER_HORIZONTAL|wx.ALIGN_CENTER_VERTICAL, 0)
        grid_sizer_2.Add(self.vecDZbox, 0, wx.ALIGN_CENTER_HORIZONTAL|wx.ALIGN_CENTER_VERTICAL, 0)
        grid_sizer_2.Add(self.button_7_copy_2, 0, wx.ALIGN_CENTER_HORIZONTAL|wx.ALIGN_CENTER_VERTICAL, 0)
        grid_sizer_2.Add(self.QuitButton, 0, wx.ALIGN_CENTER_HORIZONTAL|wx.ALIGN_CENTER_VERTICAL|wx.ADJUST_MINSIZE, 0)
        grid_sizer_2.Add(self.button_7_copy_2_copy_copy, 0, wx.ALIGN_CENTER_HORIZONTAL|wx.ALIGN_CENTER_VERTICAL, 0)
        grid_sizer_2.Add(self.button_7_copy_3, 0, wx.ALIGN_CENTER_HORIZONTAL|wx.ALIGN_CENTER_VERTICAL, 0)
        sizer_1.Add(grid_sizer_2, 1, wx.EXPAND, 0)
        sizer_2.Add((50, 30), 0, wx.ADJUST_MINSIZE, 0)
        sizer_2.Add(self.button_7_copy_4, 0, wx.ALIGN_CENTER_HORIZONTAL|wx.ALIGN_CENTER_VERTICAL, 0)
        sizer_2.Add((50, 50), 0, wx.ADJUST_MINSIZE, 0)
        sizer_2.Add(self.button_7_copy_copy, 0, wx.ALIGN_CENTER_HORIZONTAL|wx.ALIGN_CENTER_VERTICAL, 0)
        sizer_2.Add((50, 50), 0, wx.ADJUST_MINSIZE, 0)
        sizer_2.Add(self.button_7_copy_1_copy, 0, wx.ALIGN_CENTER_HORIZONTAL|wx.ALIGN_CENTER_VERTICAL, 0)
        sizer_2.Add((50, 50), 0, wx.ADJUST_MINSIZE, 0)
        sizer_2.Add(self.button_7_copy_1_copy_copy, 0, wx.ALIGN_CENTER_HORIZONTAL|wx.ALIGN_CENTER_VERTICAL, 0)
        sizer_1.Add(sizer_2, 0, wx.EXPAND, 0)
        self.notebook_1_pane_1.SetSizer(sizer_1)
        self.notebook_1.AddPage(self.notebook_1_pane_1, "Centering")
        sizer_6.Add(self.notebook_1, 1, wx.EXPAND, 0)
        sizer_5.Add(sizer_6, 1, wx.EXPAND, 0)
        self.SetSizer(sizer_5)
        sizer_5.Fit(self)
        self.Layout()
        # end wxGlade

    def clearAll(self, event): # wxGlade: MyFrame2.<event_handler>
	# Vector A
        self.vecAXbox.SetValue("%8.4f"%0)
        self.vecAYbox.SetValue("%8.4f"%0)
        self.vecAZbox.SetValue("%8.4f"%0)
	# Vector B
        self.vecBXbox.SetValue("%8.4f"%0)
        self.vecBYbox.SetValue("%8.4f"%0)
        self.vecBZbox.SetValue("%8.4f"%0)
	# Vector C
        self.vecCXbox.SetValue("%8.4f"%0)
        self.vecCYbox.SetValue("%8.4f"%0)
        self.vecCZbox.SetValue("%8.4f"%0)
	# Vector D
        self.vecDXbox.SetValue("%8.4f"%0)
        self.vecDYbox.SetValue("%8.4f"%0)
        self.vecDZbox.SetValue("%8.4f"%0)

    def push0deg(self, event): # wxGlade: MyFrame2.<event_handler>
        self.shoumen_phi=self.gonio.getPhi()
        self.shoumenBox.SetValue("%8.4f"%self.shoumen_phi)

    def pushGonioInfo(self, event): # wxGlade: MyFrame2.<event_handler>
	x,y,z=self.gonio.getXYZmm()
	phi=self.gonio.getPhi()
        self.GXbox.SetValue("%8.4f"%x)
        self.GYbox.SetValue("%8.4f"%y)
        self.GZbox.SetValue("%8.4f"%z)
        self.GPHIbox.SetValue("%8.4f"%phi)

    def setVecA(self, event): # wxGlade: MyFrame2.<event_handler>
	x,y,z=self.gonio.getXYZmm()
	phi=self.gonio.getPhi()
        self.vecAXbox.SetValue("%8.4f"%x)
        self.vecAYbox.SetValue("%8.4f"%y)
        self.vecAZbox.SetValue("%8.4f"%z)

    def setVecB(self, event): # wxGlade: MyFrame2.<event_handler>
	x,y,z=self.gonio.getXYZmm()
	phi=self.gonio.getPhi()
        self.vecBXbox.SetValue("%8.4f"%x)
        self.vecBYbox.SetValue("%8.4f"%y)
        self.vecBZbox.SetValue("%8.4f"%z)

    def setVecC(self, event): # wxGlade: MyFrame2.<event_handler>
	x,y,z=self.gonio.getXYZmm()
	phi=self.gonio.getPhi()
        self.vecCXbox.SetValue("%8.4f"%x)
        self.vecCYbox.SetValue("%8.4f"%y)
        self.vecCZbox.SetValue("%8.4f"%z)

    def setVecD(self, event): # wxGlade: MyFrame2.<event_handler>
	x,y,z=self.gonio.getXYZmm()
	phi=self.gonio.getPhi()
        self.vecDXbox.SetValue("%8.4f"%x)
        self.vecDYbox.SetValue("%8.4f"%y)
        self.vecDZbox.SetValue("%8.4f"%z)

    def pushQuit(self, event): # wxGlade: MyFrame2.<event_handler>
        self.s.close()
        print "Close connection"

    def estimation(self):
	outdir=self.datadireBox.GetValue()
        ms=MakeSchedule("./oxi.sch",outdir)

	vec_list=[]

	# VecA
        x=float(self.vecAXbox.GetValue())
        y=float(self.vecAYbox.GetValue())
        z=float(self.vecAZbox.GetValue())
        vec_list.append([x,y,z])
	# VecB
        x=float(self.vecBXbox.GetValue())
        y=float(self.vecBYbox.GetValue())
        z=float(self.vecBZbox.GetValue())
        vec_list.append([x,y,z])
	# VecC
        x=float(self.vecCXbox.GetValue())
        y=float(self.vecCYbox.GetValue())
        z=float(self.vecCZbox.GetValue())
        vec_list.append([x,y,z])
	# VecD
        x=float(self.vecDXbox.GetValue())
        y=float(self.vecDYbox.GetValue())
        z=float(self.vecDZbox.GetValue())
        vec_list.append([x,y,z])
	
        vec_list=ms.readGonioFile(sys.argv[1])
        ms.setPrefix("cco_demo")
        ms.setVectors(vec_list)
        ms.generateSchedule(0.0,80.0)
        ms.makeMergedSchedule()

    def pushCheck(self, event): # wxGlade: MyFrame2.<event_handler>
	outdir=self.datadireBox.GetValue()
	print "OUTDIR = %s"%outdir

    def pushGenerate(self, event): # wxGlade: MyFrame2.<event_handler>
        print "Event handler `pushGenerate' not implemented!"
        event.Skip()

    def pushToA(self, event): # wxGlade: MyFrame2.<event_handler>
        xa=float(self.vecAXbox.GetValue())
        ya=float(self.vecAYbox.GetValue())
        za=float(self.vecAZbox.GetValue())
	print "move to %10.4f %10.4f %10.4f"%(xa,ya,za)

        #self.gonio.moveXYZmm(xa,ya,za)

    def pushToB(self, event): # wxGlade: MyFrame2.<event_handler>
        xa=float(self.vecBXbox.GetValue())
        ya=float(self.vecBYbox.GetValue())
        za=float(self.vecBZbox.GetValue())
	print "move to %10.4f %10.4f %10.4f"%(xa,ya,za)
        #self.gonio.moveXYZmm(xa,ya,za)

    def pushToC(self, event): # wxGlade: MyFrame2.<event_handler>
        xa=float(self.vecCXbox.GetValue())
        ya=float(self.vecCYbox.GetValue())
        za=float(self.vecCZbox.GetValue())
	print "move to %10.4f %10.4f %10.4f"%(xa,ya,za)
        #self.gonio.moveXYZmm(xa,ya,za)

    def pushToD(self, event): # wxGlade: MyFrame2.<event_handler>
        xa=float(self.vecDXbox.GetValue())
        ya=float(self.vecDYbox.GetValue())
        za=float(self.vecDZbox.GetValue())
	print "move to %10.4f %10.4f %10.4f"%(xa,ya,za)
        #self.gonio.moveXYZmm(xa,ya,za)

# end of class MyFrame2

class ExpCondDialog(wx.Dialog):
    def __init__(self, *args, **kwds):
        # begin wxGlade: ExpCondDialog.__init__
        kwds["style"] = wx.DEFAULT_DIALOG_STYLE
        wx.Dialog.__init__(self, *args, **kwds)
        self.label_5 = wx.StaticText(self, -1, "Directory", style=wx.ALIGN_CENTRE)
        self.text_ctrl_1 = wx.TextCtrl(self, -1, "")
        self.label_5_copy = wx.StaticText(self, -1, "Data name", style=wx.ALIGN_CENTRE)
        self.text_ctrl_1_copy = wx.TextCtrl(self, -1, "")
        self.label_5_copy_copy = wx.StaticText(self, -1, "Start serial", style=wx.ALIGN_CENTRE)
        self.text_ctrl_1_copy_copy = wx.TextCtrl(self, -1, "")

        self.__set_properties()
        self.__do_layout()
        # end wxGlade

    def __set_properties(self):
        # begin wxGlade: ExpCondDialog.__set_properties
        self.SetTitle("dialog_1")
        self.label_5.SetMinSize((100, 18))
        self.text_ctrl_1.SetMinSize((200, 25))
        self.label_5_copy.SetMinSize((100, 25))
        self.text_ctrl_1_copy.SetMinSize((100, 25))
        self.label_5_copy_copy.SetMinSize((74, 18))
        self.text_ctrl_1_copy_copy.SetMinSize((100, 25))
        # end wxGlade

    def __do_layout(self):
        # begin wxGlade: ExpCondDialog.__do_layout
        sizer_14 = wx.BoxSizer(wx.VERTICAL)
        sizer_16_copy_4 = wx.BoxSizer(wx.HORIZONTAL)
        sizer_16 = wx.BoxSizer(wx.HORIZONTAL)
        sizer_16.Add(self.label_5, 0, wx.ALIGN_CENTER_HORIZONTAL, 0)
        sizer_16.Add(self.text_ctrl_1, 0, 0, 0)
        sizer_14.Add(sizer_16, 0, wx.EXPAND, 0)
        sizer_16_copy_4.Add(self.label_5_copy, 0, wx.ALIGN_CENTER_HORIZONTAL|wx.ALIGN_CENTER_VERTICAL, 0)
        sizer_16_copy_4.Add(self.text_ctrl_1_copy, 0, 0, 0)
        sizer_16_copy_4.Add(self.label_5_copy_copy, 0, wx.ALIGN_CENTER_HORIZONTAL|wx.ALIGN_CENTER_VERTICAL, 0)
        sizer_16_copy_4.Add(self.text_ctrl_1_copy_copy, 0, 0, 0)
        sizer_14.Add(sizer_16_copy_4, 0, wx.EXPAND, 0)
        self.SetSizer(sizer_14)
        sizer_14.Fit(self)
        self.Layout()
        # end wxGlade

# end of class ExpCondDialog


class MyFrame(wx.Frame):
    def __init__(self, *args, **kwds):
        # begin wxGlade: MyFrame.__init__
        kwds["style"] = wx.DEFAULT_FRAME_STYLE
        wx.Frame.__init__(self, *args, **kwds)

        self.__set_properties()
        self.__do_layout()
        # end wxGlade

    def __set_properties(self):
        # begin wxGlade: MyFrame.__set_properties
        self.SetTitle("frame_1")
        # end wxGlade

    def __do_layout(self):
        # begin wxGlade: MyFrame.__do_layout
        sizer_26 = wx.BoxSizer(wx.VERTICAL)
        self.SetSizer(sizer_26)
        sizer_26.Fit(self)
        self.Layout()
        # end wxGlade

# end of class MyFrame


if __name__ == "__main__":
    app = wx.PySimpleApp(0)
    wx.InitAllImageHandlers()
    frame_3 = MyFrame2(None, -1, "")
    app.SetTopWindow(frame_3)
    frame_3.Show()
    app.MainLoop()
